package dmitriy.blanutsa.coursework.controllers;import dmitriy.blanutsa.coursework.controllers.dto.ProfileDTO;import dmitriy.blanutsa.coursework.controllers.dto.RegisterRequest;import dmitriy.blanutsa.coursework.controllers.dto.ResetPasswordRequest;import dmitriy.blanutsa.coursework.persistance.models.Person;import dmitriy.blanutsa.coursework.services.UserService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.Authentication;import org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.validation.BindingResult;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.ModelAttribute;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.validation.Valid;@Controllerpublic class UserController {    private final UserService userService;    public UserController(UserService userService) {        this.userService = userService;    }    @RequestMapping("/")    public String main(Model model) {        model.addAttribute("profile", userService.getProfile());        return "profile";    }    @RequestMapping("/profile")    public String changeProfile(@ModelAttribute("profile") @Valid ProfileDTO dto, BindingResult result) {        return userService.changeProfile(dto, result);    }    @RequestMapping("/logout")    public String logout(Authentication authentication, HttpServletRequest request, HttpServletResponse responce) {        new SecurityContextLogoutHandler().logout(request, responce, authentication);        return "redirect:/login";    }    @GetMapping("/login")    public String login(Model model, String error) {        return "login";    }    @GetMapping("/register")    public String register(Model model) {        model.addAttribute("register", new RegisterRequest());        return "register";    }    @PostMapping("/register")    public String register(@ModelAttribute("register") @Valid RegisterRequest request, BindingResult result) {        return userService.register(request, result);    }    @GetMapping("/resetPassword")    public String resetPasswordPage(Model model) {        model.addAttribute("resetPassword", new ResetPasswordRequest());        return "resetPassword";    }    @PostMapping("/resetPassword")    public String resetPassword(@ModelAttribute("resetPassword") @Valid ResetPasswordRequest request, BindingResult result) {        return userService.resetPassword(request, result);    }}