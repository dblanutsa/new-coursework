package dmitriy.blanutsa.coursework.services.impl;import dmitriy.blanutsa.coursework.controllers.dto.ModelRequest;import dmitriy.blanutsa.coursework.persistance.models.Manufacturer;import dmitriy.blanutsa.coursework.persistance.models.enums.CarType;import dmitriy.blanutsa.coursework.persistance.repositories.ManufacturerRepository;import dmitriy.blanutsa.coursework.persistance.repositories.ModelRepository;import dmitriy.blanutsa.coursework.services.ModelService;import org.springframework.stereotype.Service;import org.springframework.ui.Model;import org.springframework.validation.BindingResult;import javax.transaction.Transactional;import java.util.Optional;@Servicepublic class ModelServiceImpl implements ModelService {    private final ModelRepository repository;    private final ManufacturerRepository manufacturerRepository;    public ModelServiceImpl(ModelRepository repository, ManufacturerRepository manufacturerRepository) {        this.repository = repository;        this.manufacturerRepository = manufacturerRepository;    }    @Override    public String getList(Model model) {        model.addAttribute("models", repository.findAll());        return "models";    }    @Override    @Transactional    public String add(ModelRequest request, BindingResult result, Model model) {        model.addAttribute("types", CarType.values());        model.addAttribute("manufactures", manufacturerRepository.findAll());        if (result.hasErrors()) {            return "addModel";        }        if (repository.findByName(request.getName()) != null) {            result.rejectValue("name", "error.model", "Model with this name already exists!!!");            return "addModel";        }        dmitriy.blanutsa.coursework.persistance.models.Model entity = new dmitriy.blanutsa.coursework.persistance.models.Model();        entity.setName(request.getName());        entity.setDescription(request.getDescription());        entity.setType(request.getType());        Manufacturer byId = manufacturerRepository.findById(request.getManufacturerId()).get();        entity.setManufacturer(byId);        entity.setManufacturerId(byId.getId());        repository.save(entity);        return "redirect:/models";    }    @Override    public void setModelCreateObject(Model model) {        model.addAttribute("model", new dmitriy.blanutsa.coursework.persistance.models.Model());        model.addAttribute("types", CarType.values());        model.addAttribute("manufactures", manufacturerRepository.findAll());    }}